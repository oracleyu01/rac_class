▣ 예제7.  RAC 환경에서 병렬 처리가 되는 원리 

 SQL의 성능을 높이려고 다음과 같이 병렬 힌트를 이용해서 병렬 쿼리를 수행합니다.

  select  /*+  parallel(a,2)  parallel(b,2)  */  count(*)
     from  dba_objects  a,  dba_objects  b ;

물리적으로 서로 다른 장비이다보니 병렬 쿼리를 수행할 때 충분한 
CPU 를 사용할 수 있는 장점이 있습니다. 
만약 4개의 노드로 구성된 RAC 이고 EMP 테이블을 병렬 full scan을
하면 4개의 노드에 병렬 슬레이브 프로세서들이 떠서 emp 테이블을 4등분
해서 각각 select 를 합니다.  그래서 속도가 빠르게 데이터를 검색할 수 있게 됩니다.  
            
위의 작업을 할 때 주의할 사항 ?  

병렬 슬레이브 프로세서들이 서로 메세지와 데이터를
노드간에 전송을 하게 되는데 이때 통신속도가 빨라야 합니다. 

 전송속도가 빠르게 하려고 하드웨어적으로 다음과 같이 구성합니다.

 전송속도 3가지 ?

   1. 1기가 비트 이더넷  :  초당 125메가 바이트 전송 속도
   2. 10기 기가 비트 이더넷
   3. infiniband   <--- 제일 빠른 네트워크 전송속도를 보장합니다.

  ※ RAC 환경을 구성할 때 private network 구성시 infiband 로 구성해달라고 
     애기해야합니다. 그래야 운영할때 느리지 않습니다.

   건강 보험 심사평가원의 예를 들면 OPS 로 운영되던 시스템인데
    RAC 에 슈퍼돔(HP 에서 제일 비싼 서버)을 쓰니까 그동안 느렸던 많은 일들이
    다 해결되었습니다. 

 오라클은 기본적으로 병렬 작업을 하게 되면 "인스턴스 내 병렬화" 를 시도하고
 하나의 노드의 리소스로 자원이 부족하면 "인스턴스 간 병렬화" 를 시도합니다.

※ RAC 환경에서 병렬작업과 관련해서 반드시 알아야할 파라미터 ?

  1. instance_groups
  2. parallel_instance_group

alter session set parallel_instance_group='seoul';

select  /*+ parallel(e1)  full(e1) */ count(*)
  from  emp e1;
